<!DOCTYPE html>

<html lang="cs">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes">
    <meta name="author" content="Pavel Prchal">
    <meta name="description" content="Akordy a stupnice">

    <title>Akordy a stupnice</title>
    <script type="module" src="./controls/chord.mjs" async="true"></script>
    <!-- FONT -->
    <link href='//fonts.googleapis.com/css?family=Raleway:400,300,600' rel='stylesheet' type='text/css'>

    <!-- CSS -->
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">

    <!-- Bootstrap CSS -->
    <script async="true" src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script async="true" type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.css">
</head>

<body>
    <script type="module" async="true">
        let contents = []; 
        function renderContent(n) { 
            contents[n].call(); 
        }

        function setTemplate(html){
            document.getElementById('content').innerHTML = html;
        }

        import { ChordControl } from './controls/chord.mjs';
        import { ChordTypeSelectControl } from './controls/chord_type_select.mjs';
        import { ScaleSelectControl } from './controls/scale_select.mjs';
        import { ChordReviewControl } from './controls/chord_review.mjs';
        import { ScaleReviewControl } from './controls/scale_review.mjs';
        import { ToneSelectControl } from './controls/tone_select.mjs';
        import { HarmonicaControl } from './controls/harmonica.mjs';
        import { ScaleControl } from './controls/scale.mjs';
        import { SoundControl } from './controls/sound.mjs';

        // PAGE [1]
        contents.push(() => {
            setTemplate(`<h4>Tabulka akordů </h4><label for="cbChordTypes"><div class="row">Zvolte typ akordů</label>
            <select id="cbChordTypes"></select><div id="divChordTypes"></div> </div>
            <br />
            <h4>Stupnice</h4> <select id="cbTones"></select>
            <select id="cbScales"></select>
            <div id="divOutputScale"></div>`);
            new ChordTypeSelectControl('cbChordTypes').publishTo('PAGE [1]').render(document);
            new ChordControl('divChordTypes').subscribeTo('CHORD_TYPE', 'PAGE [1]').render();
            new ToneSelectControl('cbTones').publishTo('PAGE [1]').render(document);
            new ScaleSelectControl('cbScales').publishTo('PAGE [1]').render(document);
            new ScaleControl('divOutputScale', false).subscribeTo('TONE', 'PAGE [1]')
                .subscribeTo('SCALE_TYPE', 'PAGE [1]')
                .render();
        });


        // PAGE2
        contents.push(() => {
            setTemplate('<h4>Akordy - přehled</h4><div id="divChordReview"></div><h3>Stupnice - přehled</h3><div id="divScaleReview"></div>');
            new ChordReviewControl('divChordReview', 'tableChordsReview').render();
            new ScaleReviewControl('divScaleReview', 'tableScalesReview').render();
        });

        // PAGE3
        contents.push(() => {
            setTemplate('<h4>Harmonika</h4><select id="cbHarmonicaKeys"></select><div id="divHarmonica"></div><br/><h3>Stupnice harmoniky</h3><select id="cbTonesHarp"></select><select id="cbScalesHarp"></select><div id="divOutputScaleHarp"></div>');
            new ToneSelectControl('cbHarmonicaKeys').publishTo('PAGE [3].1').render(document);
            new HarmonicaControl('divHarmonica')
                .subscribeTo('TONE', 'PAGE [3].1')
                .render();

            new ToneSelectControl('cbTonesHarp').publishTo('PAGE [3].2').render(document);
            new ScaleSelectControl('cbScalesHarp').publishTo('PAGE [3].2').render(document);
            new ScaleControl('divOutputScaleHarp', true).subscribeTo('TONE', 'PAGE [3].2')
                .subscribeTo('SCALE_TYPE', 'PAGE [3].2')
                .render();
        });

        new SoundControl().subscribeTo('PLAY_TONE');
        renderContent(0);

    </script>    

    <div class="container">
        <div class="row">
            <div class="one-third column button" onclick="renderContent(0);">Akordy</div>
            <div class="one-third column button" onclick="renderContent(1);">Katalog</div>
            <div class="one-third column button" onclick="renderContent(2);">Harmonika</div>
        </div>

        <div id="content"></div>
        
        <div>Pavel Prchal, 2020</div>
    </div>
</body>

</html>