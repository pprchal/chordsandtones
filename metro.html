<!DOCTYPE html>

<html lang="cz">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes">
    <title>t</title>

    <script src="core/shared.js"></script>
    <script src="core/database.js"></script>
    <script src="core/chordgen.js"></script>

    <script src="controls/sound_control.js"></script>
    <script src="controls/metronome_control_base.js"></script>

    <script>
        function getSelectedValue(id){
            return document.getElementById(id).selectedOptions[0].value;
        }        

        function getSelectedValue2(id){
            return document.getElementById(id).value;
        }        

    </script>

    <style>
        .metroTable {
        border-collapse: collapse;
        text-align: center;
        }
        .table, td, th {
        border: 1px solid black;
        }

        .tickA{
            background-color: rgb(241, 80, 80);
        }

        .tickB{
            background-color: rgb(255, 194, 199);
        }

    </style>
</head>

<body>
    <span>A:</span>
    <select id="cbMetroA" onchange="refreshMetronome()">
        <option>3</option>
        <option>4</option>
        <option>2</option>
        <option>5</option>
        <option>6</option>
    </select>
    <span>B:</span>
    <select id="cbMetroB" onchange="refreshMetronome()">
        <option>4</option>
        <option>3</option>
        <option>8</option>
    </select>
    <span>BPM:</span>
    <input id="tbBPM" type="text" value="40"></input>
    <a id="btStartStop" class="btn btn-primary btn-block" href="javascript:none" onclick="toggleMetronome(); return false;" role="button">Start</a>   
    <br>
    <span>syncopation:</span>
    <select id="cbMetroS" onchange="refreshMetronome()">
        <option>1</option>
        <option>2</option>
        <option>3</option>
        <option>4</option>
        <option>8</option>
        <option>16</option>
    </select>


    <br>
    <br>


    <div id="metronomeHolder"></div>                

    <script>
        function refreshMetronome(){
            let a = parseInt(getSelectedValue('cbMetroA'));
            let b = parseInt(getSelectedValue('cbMetroB'));
            let s = parseInt(getSelectedValue('cbMetroS'));
            let bpm = parseInt(getSelectedValue2('tbBPM'));
            P_CONTAINER.METRONOME.update(a, b, bpm, s);
        }

        this.P_SOUND = new SoundControl('sctl');
        let METRONOME = new MetronomeControlBase("metronomeHolder", P_SOUND);
        METRONOME.render();
        refreshMetronome();

        function toggleMetronome() {
            if(METRONOME.running){
                METRONOME.stop();
            }else{
                refreshMetronome();
                METRONOME.start();
            }
            document.getElementById('btStartStop').innerText = METRONOME.running ? "Stop" : "Start";
        }
    </script>
</body>

</html>